
import streamlit as st
import pandas as pd
import datetime
from src.config import ASSET_CONFIG
from src.data_loader import DataLoader
from src.analysis.market_analyzer import MarketAnalyzer
from src.analysis.ai_narrator import AINarrator
from src.ui import layout, charts, components

# -----------------------------------------------------------------------------
# 1. Page & Sidebar
# -----------------------------------------------------------------------------
layout.render_page_config()
settings = layout.render_sidebar()

# -----------------------------------------------------------------------------
# 2. Main Routing
# -----------------------------------------------------------------------------

if settings["page"] == "ğŸ“Š ì°¨íŠ¸ ë¶„ì„ (Analysis)":
    # Logic for Analysis Page
    start_year = settings["start_year"]
    end_year = settings["end_year"]
    asset_name = settings["asset_name"]
    asset_conf = ASSET_CONFIG[asset_name]
    
    if start_year > end_year:
        st.error("ì‹œì‘ ì—°ë„ê°€ ì¢…ë£Œ ì—°ë„ë³´ë‹¤ í½ë‹ˆë‹¤.")
    else:
        with st.spinner(f"{asset_name} ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤..."):
            combined_df = DataLoader.load_all_data(start_year, end_year, asset_conf)
            # Need strict daily price_df for chart? load_all_data returns merged.
            # charts.py expects (combined_df, price_df).
            # We can re-fetch price or modify load_all_data.
            # DataLoader has get_price_data.
            price_df = DataLoader.get_price_data(asset_conf['ticker'], start_year, end_year)

        if combined_df.empty:
             st.error(f"CFTC ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ({start_year}~{end_year})")
        elif price_df.empty:
             st.error("ê°€ê²© ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
        else:
            # --- 1. Chart Section ---
            
            # Date Range Selector (Time Machine)
            st.write("---")
            st.markdown("### ğŸ•° íƒ€ì„ë¨¸ì‹  êµ¬ê°„ ë¶„ì„ (Historical Range Analysis)")
            st.write("ìŠ¬ë¼ì´ë”ì˜ ì–‘ìª½ ëì„ ì¡°ì ˆí•˜ì—¬ **ë¶„ì„í•˜ê³  ì‹¶ì€ êµ¬ê°„(ì˜ˆ: ìƒìŠ¹ì¥ ì´ˆì…)**ì„ ì§€ì •í•˜ì„¸ìš”.")
            
            min_date = combined_df['Date'].min().date()
            max_date = combined_df['Date'].max().date()
            default_start = max_date - datetime.timedelta(weeks=12)
            
            analysis_range = st.slider(
                "ë¶„ì„ êµ¬ê°„ ì„¤ì •",
                min_value=min_date,
                max_value=max_date,
                value=(default_start, max_date),
                format="YYYY-MM-DD"
            )
            
            sel_start, sel_end = analysis_range
            
            # Render Chart
            fig = charts.plot_market_overview(
                combined_df, 
                price_df, 
                asset_conf, 
                show_dollar_value=settings["show_dollar"], 
                highlight_change=settings["highlight"],
                analysis_range=analysis_range
            )
            st.plotly_chart(fig, use_container_width=True)
            
            # --- 2. Analysis Section ---
            
            # Filter Data for Analysis
            # Use 'combined_df' which has the weekly CFTC data aligned with price
            range_df = combined_df[
                (combined_df['Date'].dt.date >= sel_start) & 
                (combined_df['Date'].dt.date <= sel_end)
            ].copy()
            
            analysis_result = MarketAnalyzer.analyze(range_df)
            
            if not analysis_result.get('is_valid'):
                st.warning(f"ë¶„ì„ ë¶ˆê°€: {analysis_result.get('error')}")
            else:
                 # UI Rendering
                 verdict = analysis_result['verdict']
                 final_color = verdict['color']
                 
                 st.markdown(f"### ğŸ“¢ AI ì¢…í•© ë¶„ì„: :{final_color}[{verdict['title']}]")
                 
                 # Color-coded Forecast
                 msg_func = st.info
                 if final_color == 'green': msg_func = st.success
                 elif final_color == 'red': msg_func = st.error
                 elif final_color in ['blue', 'orange']: msg_func = st.warning
                 
                 msg_func(f"**ğŸ”® í–¥í›„ ì „ë§ (Forecast):** {verdict['forecast']}")
                 
                 # --- 3. AI Narrative Section ---
                 if st.button("ğŸ•µï¸â€â™‚ï¸ [í—¤ì§€í€ë“œì˜ ë¹„ë°€ ê³ ë°±] ë“£ê¸° (AI Narrative)"):
                     api_key = settings["api_key"]
                     if not api_key:
                         st.warning("ğŸ” ì‚¬ì´ë“œë°” 'AI ì‹¤í—˜ì‹¤'ì— **Gemini API Key**ë¥¼ ì…ë ¥í•´ì•¼ ë“¤ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
                     else:
                         with st.spinner("ğŸ•¶ï¸ í—¤ì§€í€ë“œ ìˆ˜ì„ ì „ëµê°€ê°€ ë¹„ë°€ ì¥ë¶€ë¥¼ í™•ì¸í•˜ê³  ìˆìŠµë‹ˆë‹¤..."):
                             ai_result = AINarrator.generate_narrative(analysis_result['analysis_df'], api_key)
                             
                             if "error" in ai_result:
                                 st.error(f"AI Error: {ai_result['error']}")
                             else:
                                 # Render Cards
                                 st.success(f"**ì „ëµ ìš”ì•½**: {ai_result.get('header', '')}")
                                 components.render_ai_cards(ai_result.get('phases', []))
                                 
                                 st.markdown("---")
                                 st.markdown(f"**ğŸ”® ë¯¸ë˜ ê³„íš**: {ai_result.get('future')}")
                                 st.markdown(f"**ğŸ’¡ ì¡°ì–¸**: {ai_result.get('advice')}")

elif settings["page"] == "ğŸ“ ì´ˆë³´ì ê°€ì´ë“œ (Guide)":
    st.markdown("""
    # ğŸ’° CFTC ë¹„íŠ¸ì½”ì¸ í—¤ì§€í€ë“œ í¬ì§€ì…˜ ì¶”ì ê¸° ë§¤ë‰´ì–¼
    
    ì´ í”„ë¡œê·¸ë¨ì€ ë¯¸êµ­ ìƒí’ˆì„ ë¬¼ê±°ë˜ìœ„ì›íšŒ(CFTC)ì˜ ì£¼ê°„ ë¦¬í¬íŠ¸ë¥¼ ë¶„ì„í•˜ì—¬, **"ìŠ¤ë§ˆíŠ¸ ë¨¸ë‹ˆ(í—¤ì§€í€ë“œ)"ê°€ ë¹„íŠ¸ì½”ì¸ ì‹œì¥ì—ì„œ ì–´ë–¤ í¬ì§€ì…˜ì„ ì·¨í•˜ê³  ìˆëŠ”ì§€** ì‹œê°ì ìœ¼ë¡œ ì¶”ì í•˜ê³  ë¯¸ë˜ë¥¼ ì „ë§í•´ ì£¼ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.

    ---

    ## ğŸ“ˆ 1. ì°¨íŠ¸ ë³´ëŠ” ë²• (í•µì‹¬)

    ì´ ì°¨íŠ¸ëŠ” ë‘ ê°€ì§€ ë°ì´í„°ë¥¼ ê²¹ì³ì„œ ë³´ì—¬ì¤ë‹ˆë‹¤.

    1.  **ğŸŸ  ì£¼í™©ìƒ‰ ì„  (ì™¼ìª½ ì¶•): ë¹„íŠ¸ì½”ì¸ ê°€ê²© (BTC Price)**
        *   ìš°ë¦¬ê°€ ì•„ëŠ” ë¹„íŠ¸ì½”ì¸ ì‹œì„¸ì…ë‹ˆë‹¤.
    2.  **ğŸ”µ íŒŒë€ìƒ‰ ì„  (ì˜¤ë¥¸ìª½ ì¶•): í—¤ì§€í€ë“œ ìˆ í¬ì§€ì…˜ (Hedge Fund Short OI)**
        *   **ì´ ì„ ì´ í•µì‹¬ì…ë‹ˆë‹¤.** í—¤ì§€í€ë“œê°€ "ì°¨ìµê±°ë˜(ë¬´ìœ„í—˜ ìˆ˜ìµ)"ë¥¼ ìœ„í•´ ìŒ“ì•„ë‘” ë¬¼ëŸ‰ì…ë‹ˆë‹¤.
        *   **íŒŒë€ì„  ìƒìŠ¹ â†—ï¸:** í—¤ì§€í€ë“œê°€ í˜„ë¬¼ì„ ë§¤ì§‘í•˜ê³  ì„ ë¬¼ì„ íŒ”ê³  ìˆìŒ = **"ìƒìŠ¹ ì—ë„ˆì§€ ì¶•ì  (í˜¸ì¬)"**
        *   **íŒŒë€ì„  í•˜ë½ â†˜ï¸:** í—¤ì§€í€ë“œê°€ í˜„ë¬¼ì„ ë‚´ë‹¤ íŒ”ê³  ì§ ì‹¸ì„œ ë‚˜ê°€ëŠ” ì¤‘ = **"ë§¤ë„ í­íƒ„ íˆ¬í•˜ (ì•…ì¬)"**

    ### **ğŸ’¡ ê¿€íŒ: "ì´ë™í‰ê· ì„ " í™œìš©í•˜ê¸°**
    í—¤ì§€í€ë“œ ë°ì´í„°ëŠ” ë§¤ì£¼ ë°œí‘œë˜ë¯€ë¡œ ì°¨íŠ¸ê°€ ì§€ê·¸ì¬ê·¸ë¡œ ê±°ì¹ ê²Œ ë³´ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ì°¨íŠ¸ì— ìë™ ìŠ¤ë¬´ë”© ì ìš©ë¨)

    ---

    ## ğŸ¤– 2. ìŠ¤ë§ˆíŠ¸ ë¨¸ë‹ˆ ë¶„ì„ ì—”ì§„ í•´ì„

    ì°¨íŠ¸ ì•„ë˜ì— AI ë¡œì§ì´ í˜„ì¬ ì‹œì¥ ìƒí™©ì„ 6ê°€ì§€ë¡œ ì§„ë‹¨í•´ ì¤ë‹ˆë‹¤.

    *   **ì§„ë‹¨ëª…:** í˜„ì¬ ì‹œì¥ì˜ ìƒíƒœ (ì˜ˆ: ğŸš€ ìƒìŠ¹ ê°€ì† êµ¬ê°„)
    *   **ğŸ“Š íŒë‹¨ ê·¼ê±° (Evidence):**
        *   **OI ë³€í™”ìœ¨:** í—¤ì§€í€ë“œ ë¬¼ëŸ‰ì´ ì–¼ë§ˆë‚˜ ëŠ˜ì—ˆëŠ”ì§€/ì¤„ì—ˆëŠ”ì§€ (+15% ê¸‰ì¦ ë“±)
        *   **ê°€ê²© ë³€í™”ìœ¨:** ê°™ì€ ê¸°ê°„ ê°€ê²©ì€ ì–´ë–»ê²Œ ì›€ì§ì˜€ëŠ”ì§€
        *   **ìƒê´€ê³„ìˆ˜:** ë‘˜ì´ ê°™ì´ ì›€ì§ì´ëŠ”ì§€(ë™ì¡°), ë”°ë¡œ ë…¸ëŠ”ì§€(ê´´ë¦¬)
    *   **ğŸ”® ë¯¸ë˜ ì „ë§:** ê·¸ë˜ì„œ ì•ìœ¼ë¡œ ì–´ë–»ê²Œ í•´ì•¼ í•˜ëŠ”ì§€ (ë§¤ìˆ˜/ë§¤ë„/ê´€ë§)

    ---

    ## ğŸ’¼ 3. ì‹¤ì „: ì‚¬ê³„ì ˆ ëˆ ë³µì‚¬ ê°€ì´ë“œ (Market Scenarios)

    í—¤ì§€í€ë“œëŠ” ë¹„ê°€ ì˜¤ë‚˜ ëˆˆì´ ì˜¤ë‚˜ ëˆì„ ë²•ë‹ˆë‹¤. ìƒí™©ë³„ë¡œ ê·¸ë“¤ì˜ í–‰ë™ì„ í›”ì³ë´…ì‹œë‹¤.

    ### **ğŸŒ 1. ìƒìŠ¹ì¥ (Uptrend) - "ì”¨ ë¿Œë¦¬ê¸°"**
    *   **ìƒí™©:** ë¹„íŠ¸ì½”ì¸ ê°€ê²© ìƒìŠ¹ ğŸ“ˆ + ì„ ë¬¼ í”„ë¦¬ë¯¸ì—„ í™•ëŒ€
    *   **í–‰ë™:** **í˜„ë¬¼ ë§¤ìˆ˜ + ì„ ë¬¼ ìˆ (Cash-and-Carry)**
    *   **ëª©í‘œ:** **"ë¬´ìœ„í—˜ í™•ì • ì´ì"** í™•ë³´.
    *   **í•´ì„:** ê°€ê²©ì´ ì˜¤ë¥¼ìˆ˜ë¡ ì„ ë¬¼ì´ í˜„ë¬¼ë³´ë‹¤ ë” ë¹„ì‹¸ì§€ë¯€ë¡œ, ì´ 'ê°­(Gap)'ì„ ë¨¹ê¸° ìœ„í•´ ë¯¸ì¹œë“¯ì´ ìˆì„ ì¹©ë‹ˆë‹¤. (**íŒŒë€ì„  ê¸‰ë“± = ìƒìŠ¹ì¥ ì‹ í˜¸**)

    ### **â›ˆï¸ 2. í•˜ë½ì¥ (Downtrend) - "ìˆ˜í™•í•˜ê¸°"**
    *   **ìƒí™©:** ë¹„íŠ¸ì½”ì¸ ê°€ê²© í•˜ë½ ğŸ“‰
    *   **í–‰ë™:** **ì„ ë¬¼ ìˆ ì²­ì‚° (Unwinding) + í˜„ë¬¼ ë§¤ë„**
    *   **ëª©í‘œ:** **"ì´ìµ ì‹¤í˜„"**.
    *   **ì›ë¦¬:** 1ì–µì— ì‚° í˜„ë¬¼ì´ 8ì²œë§Œì›ì´ ë˜ì–´ë„(-2ì²œ ì†ì‹¤), 1ì–µ1ì²œì— ì¹œ ìˆì„ 8ì²œì— ê°šìœ¼ë©´(+3ì²œ ì´ìµ) **ê²°êµ­ +1ì²œë§Œì›ì„ ë²•ë‹ˆë‹¤.**
    *   **í•´ì„:** í•˜ë½ì¥ì— ìˆ ë¬¼ëŸ‰ì´ ì¤„ì–´ë“œëŠ” ê²ƒì€ ê·¸ë“¤ì´ **"ìµì ˆí•˜ê³  í‡´ê·¼ ì¤‘"**ì´ë¼ëŠ” ëœ»ì…ë‹ˆë‹¤.

    ### **ğŸŒªï¸ 3. íš¡ë³´ì¥ (Sideways) - "ì´ì ë°›ê¸°"**
    *   **ìƒí™©:** ê°€ê²©ì´ ì§€ë£¨í•˜ê²Œ ì˜†ìœ¼ë¡œ ê¸°ì–´ê°ˆ ë•Œ ğŸ˜‘
    *   **í–‰ë™:** **í¬ì§€ì…˜ ìœ ì§€ (Funding Fee Farming)**
    *   **ëª©í‘œ:** **"í€ë”©ë¹„(ì´ì)"** ë”°ë¨¹ê¸°.
    *   **ì›ë¦¬:** í¬ì§€ì…˜ì„ ì¡ê³ ë§Œ ìˆì–´ë„, 8ì‹œê°„ë§ˆë‹¤ ë¡±(ë§¤ìˆ˜) í¬ì§€ì…˜ ë³´ìœ ìë“¤ì—ê²Œì„œ **í˜„ê¸ˆìœ¼ë¡œ ì´ì(Funding Fee)**ë¥¼ ëœ¯ì–´ëƒ…ë‹ˆë‹¤. (ì—° 10~20% ìˆ˜ìµ)

    ---

    ### **âš–ï¸ [Tip] ì‹œì¥ ì •í™” ê¸°ëŠ¥ (Market Impact)**
    
    1.  **í—¤ì§€í€ë“œì˜ í–‰ë™ì´ ê°€ê²©ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ (ì‹œì¥ ìˆœê¸°ëŠ¥)**
        *   í—¤ì§€í€ë“œê°€ **í˜„ë¬¼ì„ ì‚¬ê³ (ğŸ“ˆ)** + **ì„ ë¬¼ì„ íŒ”ë©´(ğŸ“‰)** ì–´ë–»ê²Œ ë ê¹Œìš”?
        *   ê²°êµ­ í˜„ë¬¼ ê°€ê²©ì€ ì˜¤ë¥´ê³ , ë¹„ì •ìƒì ìœ¼ë¡œ ë†’ì•˜ë˜ ì„ ë¬¼ ê°€ê²©ì€ ë‚´ë ¤ì˜¤ë©´ì„œ **ë‘ ê°€ê²© ì°¨ì´ê°€ ì¤„ì–´ë“­ë‹ˆë‹¤.**
        *   ì¦‰, ê·¸ë“¤ì´ ëˆì„ ë²Œë ¤ê³  í•˜ëŠ” ì´ í–‰ë™ì´ ì—­ì„¤ì ìœ¼ë¡œ **ì‹œì¥ì˜ ê±°í’ˆì„ ë„ê³  ê°€ê²©ì„ ì •ìƒí™”**ì‹œí‚¤ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.

    ---

    ## ğŸ“ 4. ì‹¬í™”: ì™œ ì„ ë¬¼ì´ í˜„ë¬¼ë³´ë‹¤ ë¹„ì‹¼ê°€ìš”? (Contango)

    **Q. "ê°€ê²©ì´ ì˜¤ë¥¼ìˆ˜ë¡ ì„ ë¬¼ì´ í˜„ë¬¼ë³´ë‹¤ ë” ë¹„ì‹¸ì§„ë‹¤"ê³  í–ˆëŠ”ë°, ì™œ í•­ìƒ ê·¸ëŸ°ê°€ìš”?**
    
    ì´ í˜„ìƒì„ **'ì½˜íƒ±ê³ (Contango)'**ë¼ê³  í•˜ë©°, ì •ìƒì ì¸ ê¸ˆìœµ ì‹œì¥ì˜ íŠ¹ì§•ì…ë‹ˆë‹¤. ì´ìœ ëŠ” í¬ê²Œ ë‘ ê°€ì§€ì…ë‹ˆë‹¤.

    ### **1. ëˆì˜ ê¸°íšŒë¹„ìš© (ì´ì)** ğŸ’¸
    *   í˜„ë¬¼ì„ ì‚¬ë ¤ë©´ ì§€ê¸ˆ ë‹¹ì¥ 1ì–µì´ í•„ìš”í•˜ì§€ë§Œ, ì„ ë¬¼ì„ ì‚¬ë ¤ë©´ ì¦ê±°ê¸ˆ(ì•½ 1ì²œë§Œì›)ë§Œ ìˆìœ¼ë©´ ë©ë‹ˆë‹¤.
    *   ì‚¬ëŒë“¤ì€ ë‚˜ë¨¸ì§€ ëˆ(9ì²œë§Œì›)ì„ ì€í–‰ì— ë„£ì–´ ì´ìë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    *   ë”°ë¼ì„œ ì„ ë¬¼ ë§¤ìˆ˜ìëŠ” **"ë‚´ê°€ í˜„ê¸ˆì„ ì•„ë¼ëŠ” ëŒ€ì‹ , ê·¸ ì´ìë¹„ìš©ë§Œí¼ ì„ ë¬¼ ê°€ê²©ì— ì–¹ì–´ì„œ ì£¼ê² ë‹¤"**ëŠ” í•©ì˜ê°€ ìƒê¹ë‹ˆë‹¤. ê¸ˆë¦¬ê°€ ë†’ì„ìˆ˜ë¡ ì„ ë¬¼ì€ ë” ë¹„ì‹¸ì§‘ë‹ˆë‹¤.

    ### **2. êµ¬ì¡°ì  ë§¤ìˆ˜ ìš°ìœ„ (Structural Long Bias)** ğŸ“Š
    *   **ê·¼ê±°:** ì£¼ì‹ì´ë‚˜ ì•”í˜¸í™”í ì‹œì¥ ì°¸ì—¬ìì˜ 90% ì´ìƒì€ ê°€ê²© ìƒìŠ¹ì„ ê¸°ëŒ€í•˜ëŠ” **'ë§¤ìˆ˜(Long) í¬ì§€ì…˜'** ë³´ìœ ìì…ë‹ˆë‹¤. ë°˜ë©´ ê°€ê²© í•˜ë½ì— ë² íŒ…í•˜ëŠ” ê³µë§¤ë„(Short) ì„¸ë ¥ì€ ê·¹ì†Œìˆ˜ì˜ ì „ë¬¸ê°€ë¿ì…ë‹ˆë‹¤.
    *   **ê²°ê³¼:** "ì‚¬ê³  ì‹¶ì€ ì‚¬ëŒ"ì´ "íŒ”ê³  ì‹¶ì€ ì‚¬ëŒ"ë³´ë‹¤ êµ¬ì¡°ì ìœ¼ë¡œ í•­ìƒ ë§ê¸° ë•Œë¬¸ì—, ì„ ë¬¼ì„ ë¨¼ì € í™•ë³´í•˜ë ¤ëŠ” ìˆ˜ìš”ê°€ ëª°ë ¤ **ë§Œì„±ì ì¸ ì´ˆê³¼ìˆ˜ìš”(Premium)** ìƒíƒœê°€ ìœ ì§€ë©ë‹ˆë‹¤.

    ### **3. ë ˆë²„ë¦¬ì§€ì˜ ìœ í˜¹ (Gambler's Premium)** ğŸ°
    *   ì„ ë¬¼ ì‹œì¥ì€ 1ì²œë§Œì›ìœ¼ë¡œ 1ì–µì¹˜ ë¹„íŠ¸ì½”ì¸ì„ ì‚´ ìˆ˜ ìˆëŠ” **'ë ˆë²„ë¦¬ì§€(Leverage)'**ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
    *   ì´ê²ƒì´ **ë„ë°•ì„±(Gamification)**ì„ ìê·¹í•˜ì—¬, ì ì€ ëˆìœ¼ë¡œ ì¸ìƒ ì—­ì „(í•œë°©)ì„ ë…¸ë¦¬ëŠ” íˆ¬ê¸°ì  ìˆ˜ìš”ê°€ ëª°ë¦½ë‹ˆë‹¤.
    *   ì´ë“¤ì€ **"ìˆ˜ìˆ˜ë£Œë‚˜ ì›ƒëˆ(Premium) ì¢€ ì¤˜ë„ ëŒ€ë°•ë‚˜ë©´ ê·¸ë§Œ"**ì´ë¼ëŠ” ë§ˆì¸ë“œë¡œ ë¤ë¹„ê¸° ë•Œë¬¸ì—, ì„ ë¬¼ì´ í•­ìƒ ë¹„ì‹¸ê²Œ ê±°ë˜ë˜ëŠ” ì›ì¸ì´ ë©ë‹ˆë‹¤.

    ### **ğŸš¨ ì˜ˆì™¸: ë°±ì›Œë°ì´ì…˜ (Backwardation)**
    *   í•­ìƒ ë¹„ì‹¼ ê±´ ì•„ë‹™ë‹ˆë‹¤. **ì‹œì¥ í­ë½ì¥**ì´ë‚˜ **ê³µí¬ êµ¬ê°„**ì—ì„œëŠ” ë°˜ëŒ€ í˜„ìƒì´ ì¼ì–´ë‚©ë‹ˆë‹¤.
    *   ë‹¤ë“¤ "ì§€ê¸ˆ ë‹¹ì¥ íŒ”ê³  íƒˆì¶œí•˜ê³  ì‹¶ì–´!"ë¼ê³  ì•„ìš°ì„±ì¹˜ë©´, **ì„ ë¬¼ ê°€ê²©ì´ í˜„ë¬¼ë³´ë‹¤ ë” ì‹¸ì§€ëŠ”(ì—­í”„ë¦¬ë¯¸ì—„)** ê¸°ì´í•œ í˜„ìƒì´ ë°œìƒí•©ë‹ˆë‹¤. ì´ë•Œê°€ ë³´í†µ **'ì—­ì‚¬ì ì¸ ì €ì '**ì¼ í™•ë¥ ì´ ë†’ìŠµë‹ˆë‹¤.

    ---

    ## ğŸ§  4. í•µì‹¬ ì›ë¦¬ ë³µìŠµ: ì™œ 'ìˆ'ì¸ë° í˜¸ì¬ì¸ê°€?
    
    ì•„ì§ë„ **"í—¤ì§€í€ë“œê°€ ìˆì„ ì¹˜ëŠ”ë° ì™œ ê°€ê²©ì´ ì˜¤ë¥´ì§€?"** í—·ê°ˆë¦¬ì‹œë‚˜ìš”? ì´ **'ì—­ì„¤(Paradox)'**ì´ ê°€ì¥ ì¤‘ìš”í•©ë‹ˆë‹¤.

    1.  **í—¤ì§€í€ë“œëŠ” ê²ìŸì´ì…ë‹ˆë‹¤ (Risk Aversion)**
        *   ê·¸ë“¤ì€ ê°€ê²©ì´ ì˜¤ë¥¼ì§€ ë‚´ë¦´ì§€ ë§ì¶”ëŠ” ë„ë°•ì„ ì‹«ì–´í•©ë‹ˆë‹¤. ì˜¤ì§ **'100% ì•ˆì „í•œ ìˆ˜ìµ'**ë§Œ ì›í•©ë‹ˆë‹¤.

    2.  **ê·¸ë˜ì„œ 'ì–‘ë°©í–¥' ë°°íŒ…ì„ í•©ë‹ˆë‹¤ (Cash-and-Carry)**
        *   **í˜„ë¬¼ ë§¤ìˆ˜ (+):** ê°€ê²©ì´ ì˜¤ë¥´ë©´ ëˆì„ ë²” â†—ï¸
        *   **ì„ ë¬¼ ë§¤ë„ (-):** ê°€ê²©ì´ ë‚´ë¦¬ë©´ ëˆì„ ë²” â†˜ï¸
        *   **ì‰½ê²Œ í’€ì–´ë³¸ 3ë‹¨ê³„ ì ˆì°¨:**
            1.  **ì¡°ê±´ í™•ì¸:** "ì–´? ì§€ê¸ˆ ë¹„íŠ¸ì½”ì¸ í˜„ë¬¼ì€ 1ì–µì¸ë°, ì„ ë¬¼ì€ 1ì–µ 1ì²œë§Œì›ì´ë„¤?" (**ë¹„ìŒ€ ë•Œë§Œ ê°€ëŠ¥**)
            2.  **ë™ì‹œ ì£¼ë¬¸:** í˜„ë¬¼ì„ 1ì–µì— ì‚¬ê³ , ë™ì‹œì— ì„ ë¬¼ì„ 1ì–µ 1ì²œë§Œì›ì— íŒë‹ˆë‹¤. (ì°¨ìµ 1ì²œë§Œì› í™•ì •)
            3.  **ê²°ê³¼ (ì™œ ë¬´ì¡°ê±´ ë²„ëŠ”ê°€?):**
                *   ë§Œì•½ ë¹„íŠ¸ì½”ì¸ì´ **2ì–µìœ¼ë¡œ í­ë“±**í•˜ë©´? í˜„ë¬¼ì—ì„œ 1ì–µ ë²Œê³ , ì„ ë¬¼ì—ì„œ 9ì²œë§Œì› ì†í•´ë´ì„œ â†’ **í•©ê³„ +1ì²œë§Œì› ì´ìµ**
                *   ë§Œì•½ ë¹„íŠ¸ì½”ì¸ì´ **10ì›ìœ¼ë¡œ í­ë½**í•˜ë©´? í˜„ë¬¼ì—ì„œ ë§í•˜ì§€ë§Œ, ì„ ë¬¼ì—ì„œ ì´ˆëŒ€ë°•ì´ ë‚˜ì„œ â†’ **í•©ê³„ +1ì²œë§Œì› ì´ìµ**
                *   ì¦‰, ì§€ê¸ˆ ì°¨ì´ê°€ ì–¼ë§ˆë‚˜ ë‚˜ë“ , ë§Œê¸°ì¼ê¹Œì§€ ë²„í‹°ë©´ **100% í™•ë¥ ë¡œ ì´ ì°¨ì´(Premium)ê°€ ë‚´ ì£¼ë¨¸ë‹ˆë¡œ ë“¤ì–´ì˜¤ê²Œ ì„¤ê³„**ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ 'ìˆ˜í•™ì  í™•ì‹¤ì„±' ë•Œë¬¸ì— ê·¸ë“¤ì´ ë°°íŒ…í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

    2.  **ë°˜ëŒ€ë¡œëŠ” ëˆì„ ëª» ë²„ë‚˜ìš”? (Reverse Arbitrage)**
        *   **"í˜„ë¬¼ ë§¤ë„ + ì„ ë¬¼ ë§¤ìˆ˜"** ì „ëµì„ ë§í•˜ëŠ”ë°, ì´ëŠ” **ì„ ë¬¼ ê°€ê²©ì´ í˜„ë¬¼ë³´ë‹¤ ë” ìŒ€ ë•Œ(ì—­í”„ë¦¬ë¯¸ì—„/Backwardation)**ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.
        *   ë¹„íŠ¸ì½”ì¸ ì‹œì¥ì€ ëŒ€ë¶€ë¶„ ìƒìŠ¹ ê¸°ëŒ€ê°ì´ ê¹”ë ¤ ìˆì–´ì„œ ì„ ë¬¼ì´ ë” ë¹„ì‹¼ ê²½ìš°ê°€ 90%ì…ë‹ˆë‹¤. ê·¸ë˜ì„œ í—¤ì§€í€ë“œëŠ” ì£¼ë¡œ 'ìˆ(ì„ ë¬¼ ë§¤ë„)' í¬ì§€ì…˜ì„ ì¡ëŠ” ê²ƒì…ë‹ˆë‹¤.
        *   ê°€ë” ëŒ€í­ë½ì¥ì—ì„œ ì„ ë¬¼ì´ í˜„ë¬¼ë³´ë‹¤ ì‹¸ì§€ë©´ ì´ ì „ëµì„ ì“°ê¸°ë„ í•©ë‹ˆë‹¤.

    ---

    3.  **ê²°ë¡ : íŒŒë€ì„ ì˜ ì§„ì§œ ì˜ë¯¸ ğŸ•µï¸**
        *   ì°¨íŠ¸ì—ì„œ **íŒŒë€ì„ (ìˆ ë¬¼ëŸ‰/OI)**ì´ í•˜ëŠ˜ë¡œ ì¹˜ì†Ÿê³  ìˆë‚˜ìš”? ê·¸ê²ƒì€ í—¤ì§€í€ë“œê°€ **"ë‚˜ ì§€ê¸ˆ ë¹„íŠ¸ì½”ì¸ í˜„ë¬¼ì„ ë¯¸ì¹œë“¯ì´ ì‚¬ëª¨ìœ¼ê³  ìˆì–´!"**ë¼ê³  í™•ì„±ê¸°ì— ëŒ€ê³  ì†Œë¦¬ì¹˜ëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤. ì ˆëŒ€ ê²ë¨¹ì§€ ë§ˆì„¸ìš”.

    ---

    ## â“ 5. ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ (FAQ)
    
    **Q. 2024ë…„ ì´í›„ ì´ ì§€í‘œê°€ ë” ì˜ ë§ëŠ” ì´ìœ ëŠ”?**
    *   **A.** ë¹„íŠ¸ì½”ì¸ í˜„ë¬¼ ETF ìŠ¹ì¸ ì´í›„, ì›”ê°€(Wall St.)ì˜ ê±°ëŒ€ ìë³¸ì´ ì‹œì¥ì— ë“¤ì–´ì™”ìŠµë‹ˆë‹¤. ì´ë“¤ì€ 'ì½”ì¸ì˜ ê¿ˆ'ë³´ë‹¤ëŠ” **'í™•ì‹¤í•œ ì´ì ìˆ˜ìµ(ì—° 10~15%)'**ì„ ë…¸ë¦¬ê³  ë“¤ì–´ì™”ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì´ 'ì´ì ë†ì‚¬ ì§€í‘œ(ìˆ OI)'ê°€ ê³§ ê°€ê²©ì˜ í–¥ë°©ì„ ê²°ì •í•˜ëŠ” ê°€ì¥ í°ì†ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.

    ---
    
    **Created by Antigravity**
    """)
